<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Do Bhai Chaap Wale | Nangloi, New Delhi</title>
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:#fdfdfd; color:#333; }
    header { background:#2e2e2e; color:#fff; padding:60px 20px; text-align:center; }
    header h1 { font-size:3rem; margin:0; }
    .tagline { font-size:1.2rem; margin:10px 0 20px; }
    .btn-primary, .btn-view-cart {
      background:#e91e63; color:#fff; padding:8px 16px;
      border:none; border-radius:20px; cursor:pointer; margin:4px 0;
    }
    .btn-view-cart {
      position:fixed; bottom:20px; right:20px; z-index:1000; display:none;
    }
    section { padding:40px 20px; max-width:1000px; margin:auto; }
    h2 { color:#e91e63; margin-bottom:20px; }
    ul { list-style:none; padding:0; }
    li {
      padding:8px 0; border-bottom:1px solid #ddd;
      display:flex; justify-content:space-between; align-items:center; flex-wrap: wrap;
    }
    footer { background:#222; color:#aaa; text-align:center; padding:20px; font-size:0.9rem; }
    #cart {
      background:#fff0f4; padding:20px; margin:30px auto;
      border:1px solid #e91e63; border-radius:10px;
    }
    input, textarea, select {
      width:100%; padding:8px; margin:6px 0;
      border:1px solid #ccc; border-radius:5px;
    }
    #login { background:#e8f0ff; padding:20px; margin:30px auto; border-radius:10px; }
  </style>
</head>
<body>

<header>
  <h1>Do Bhai Chaap Wale</h1>
  <p class="tagline">Authentic Chaap & Street-Style Fast Food</p>
  <a href="#menu" class="btn-primary">Explore Menu</a>
</header>

<button id="view-cart-toggle" class="btn-view-cart" onclick="scrollToCart()">View Cart</button>

<section id="login">
  <h2>üë§ Customer Login</h2>
  <input type="text" id="login-mobile" placeholder="Enter your Mobile Number" />
  <button onclick="login()" class="btn-primary">Login</button>
  <div id="order-history" style="margin-top:20px;"></div>
</section>

<section id="menu">
  <h2>Our Delicious Menu</h2>
  <ul id="menu-list"></ul>
</section>

<section id="cart">
  <h2>üõí Your Cart</h2>
  <div id="cart-items"><em>No items in cart.</em></div>
  <p id="total-amount">Total: ‚Çπ0</p>

  <h3>Customer Details</h3>
  <input type="text" id="cust-name" placeholder="Full Name" />
  <input type="tel" id="cust-mobile" placeholder="Mobile Number" />
  <textarea id="cust-address" placeholder="Full Address"></textarea>

  <button onclick="checkout()" class="btn-primary">Proceed to Pay</button>
</section>

<footer>
  <p>&copy; 2025 Do Bhai Chaap Wale</p>
</footer>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<!-- üî• Firebase CDN (required) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
  firebase.initializeApp({
    apiKey: "AIzaSyADDoSv7Wt8WOfYkcAYZcQOZtCKROuHMu4",
    authDomain: "dobhaichaapwale1.firebaseapp.com",
    projectId: "dobhaichaapwale1",
    storageBucket: "dobhaichaapwale1.firebasestorage.app",
    messagingSenderId: "141034963645",
    appId: "1:141034963645:web:442a93b6e87643b3bf2dd4"
  });

  // ‚úÖ THIS WAS MISSING
  window._db = firebase.firestore();
</script>


<script>
let cart = [];

const menuItems = [
  { name: "Malai Chaap", half: 130, full: 190 },
  { name: "Extra Malai Chaap", half: 150, full: 210 },
  { name: "Masala Chaap", half: 130, full: 190 },
  { name: "Tandoori Chaap", half: 130, full: 190 },
  { name: "Achari Chaap", half: 140, full: 200 },
  { name: "Spl. Afghani Chaap", half: 140, full: 200 },
  { name: "Lemon Chaap", half: 140, full: 200 },
  { name: "Hariyali Chaap", half: 140, full: 200 },
  { name: "Pudina Chaap", half: 140, full: 200 },
  { name: "Malai Tikka Chaap", half: 150, full: 210 },
  { name: "Stuff Chaap", half: 160, full: 220 },
  { name: "Garlic Chaap", half: 160, full: 220 },
  { name: "Tawa Chaap", half: 160, full: 220 },
  { name: "Veg Tandoori Butter Leg Piece", half: 130, full: 190 },
  { name: "Plain Roti", price: 6 },
  { name: "Butter Roti", price: 7 },
  { name: "Tawa Roti", price: 6 },
  { name: "Tawa Butter Roti", price: 7 },
  { name: "Rumali Roti", price: 8 },
  { name: "Missi Roti", price: 25 },
  { name: "Laccha Parantha", price: 25 },
  { name: "Stuff Naan", price: 35 },
  { name: "Plain Naan", price: 25 },
  { name: "Butter Naan", price: 30 },
  { name: "2pcs Chaap + 2 Butter Roti", price: 120 },
  { name: "Creamy Onion", price: 20 },
  { name: "Malai Chaap Roll", four: 110, six: 170 },
  { name: "Masala Chaap Roll", four: 110, six: 170 },
  { name: "Tandoori Chaap Roll", four: 120, six: 170 },
  { name: "Afgani Chaap Roll", four: 120, six: 170 },
  { name: "Achari Chaap Roll", four: 120, six: 170 },
  { name: "Lemon Chaap Roll", four: 120, six: 230 },
  { name: "Hariyali Chaap Roll", four: 120, six: 230 },
  { name: "Pudina Chaap Roll", four: 120, six: 230 },
  { name: "Garlic Chaap Roll", four: 120, six: 230 },
  { name: "Stuff Chaap Roll", four: 120, six: 230 }
];

document.addEventListener("DOMContentLoaded", () => {
  const menu = document.getElementById("menu-list");
  menuItems.forEach(item => {
    const li = document.createElement("li");
    if (item.half) {
      li.innerHTML = `${item.name} ‚Äî Half ‚Çπ${item.half} / Full ‚Çπ${item.full}
      <button onclick="addToCart('${item.name} (Half)',${item.half})" class="btn-primary">Add Half</button>
      <button onclick="addToCart('${item.name} (Full)',${item.full})" class="btn-primary">Add Full</button>`;
    } else if (item.four) {
      li.innerHTML = `${item.name} ‚Äî 4pcs ‚Çπ${item.four} / 6pcs ‚Çπ${item.six}
      <button onclick="addToCart('${item.name} (4pcs)',${item.four})" class="btn-primary">Add 4pcs</button>
      <button onclick="addToCart('${item.name} (6pcs)',${item.six})" class="btn-primary">Add 6pcs</button>`;
    } else {
      li.innerHTML = `${item.name} ‚Äî ‚Çπ${item.price}
      <button onclick="addToCart('${item.name}',${item.price})" class="btn-primary">Add</button>`;
    }
    menu.appendChild(li);
  });
});

function addToCart(name, price) {
  const f = cart.find(i => i.name === name);
  if (f) f.qty++; else cart.push({ name, price, qty: 1 });
  updateCart();
  document.getElementById("view-cart-toggle").style.display = "block";
}

function updateCart() {
  let total = 0;
  const div = document.getElementById("cart-items");
  div.innerHTML = "";
  cart.forEach(i => {
    total += i.price * i.qty;
    div.innerHTML += `${i.name} √ó ${i.qty} = ‚Çπ${i.price * i.qty}<br>`;
  });
  document.getElementById("total-amount").innerText = "Total: ‚Çπ" + total;
}

function scrollToCart() {
  document.getElementById("cart").scrollIntoView({ behavior: "smooth" });
}

function checkout() {
  const name = document.getElementById("cust-name").value.trim();
  const mobile = document.getElementById("cust-mobile").value.trim();
  const address = document.getElementById("cust-address").value.trim();

  if (!name || !mobile || !address) {
    alert("Please fill all customer details before proceeding.");
    return;
  }

  if (cart.length === 0) {
    alert("Cart is empty!");
    return;
  }

  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);

  const options = {
    key: "rzp_live_IAwVGH2rtMwKWw", // your original Razorpay key
    amount: total * 100,
    currency: "INR",
    name: "Do Bhai Chaap Wale",
    description: "Online Food Order",

handler: async function (response) {

  // 1Ô∏è‚É£ SAVE ORDER TO FIRESTORE
  if (window._db) {
    await window._db.collection("orders").add({
      name,
      mobile,
      address,
      items: cart,
      total,
      paymentId: response.razorpay_payment_id,
      created: firebase.firestore.FieldValue.serverTimestamp()
    });
  }

  // 2Ô∏è‚É£ BUILD WHATSAPP MESSAGE
  let itemsText = cart
    .map(i => `‚Ä¢ ${i.name} x ${i.qty} = ‚Çπ${i.price * i.qty}`)
    .join('%0A');

  let waMessage =
    `üõéÔ∏è NEW ORDER ‚Äì Do Bhai Chaap Wale%0A%0A` +
    `üë§ Name: ${name}%0A` +
    `üìû Mobile: ${mobile}%0A` +
    `üè† Address: ${address}%0A%0A` +
    `üçΩÔ∏è Items:%0A${itemsText}%0A%0A` +
    `üí∞ Total: ‚Çπ${total}%0A` +
    `üí≥ Payment ID: ${response.razorpay_payment_id}`;

  let waUrl = `https://wa.me/918700494451?text=${waMessage}`;

  // 3Ô∏è‚É£ SUCCESS UI + SAFE WHATSAPP BUTTON
  document.getElementById("inform-us-box").style.display = "block";
  document.getElementById("waBtn").onclick = function () {
    window.location.href = waUrl;
  };

  alert("‚úÖ Payment successful! ID: " + response.razorpay_payment_id);

  cart = [];
  updateCart();
},


    theme: { color: "#e91e63" }
  };

  const rzp = new Razorpay(options);
  rzp.open();


function login() {
  alert("Baseline file confirmed.");
}
</script>

<script>
  console.log("Firebase check:", typeof firebase);
</script>
</body>
</html>
